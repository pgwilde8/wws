{% extends "layout/base.html" %}
{% block title %}Admin – Call: {{ call.id }}{% endblock %}
{% block header %}{% endblock %}
{% block footer %}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto p-4 sm:p-6 space-y-6">

  <!-- Header -->
  <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-200">
    <h1 class="text-xl sm:text-2xl font-extrabold text-gray-900">Call Detail</h1>
    <p class="text-xs text-gray-500 font-mono">ID: {{ call.id }}</p>
  </div>

  <!-- Client & Project -->
  <div class="grid sm:grid-cols-1 md:grid-cols-2 gap-4 text-sm">
    <div class="bg-white border p-4 rounded-xl shadow-sm">
      <div class="font-semibold">Client</div>
      <p class="text-xs text-gray-500">{{ call.client_name or "—" }}</p>
      {% if call.client_id %}
        <a href="/admin/clients/{{ call.client_id }}" class="text-blue-600 text-xs font-bold hover:underline">View Client →</a>
      {% endif %}
    </div>

    <div class="bg-white border p-4 rounded-xl shadow-sm">
      <div class="font-semibold">Project</div>
      <p class="text-xs text-gray-500">{{ call.project_name or "General Inquiry" }}</p>
      {% if call.project_id %}
        <a href="/admin/projects/{{ call.project_id }}" class="text-blue-600 text-xs font-bold hover:underline">View Project →</a>
      {% endif %}
    </div>
  </div>

  <!-- Transcript -->
  <section class="bg-white border p-4 rounded-xl shadow-sm">
    <h2 class="text-sm font-bold text-gray-900 mb-2">Transcript</h2>
    {% if call.transcript %}
    <div class="bg-gray-900 text-gray-100 text-xs font-mono p-3 rounded-lg whitespace-pre-wrap max-h-[320px] overflow-y-auto">
      {{ call.transcript }}
    </div>
    {% else %}
      <p class="text-xs text-gray-500">No transcript available yet.</p>
    {% endif %}
  </section>

  <!-- Meta -->
  <section class="bg-white border p-4 rounded-xl shadow-sm grid grid-cols-2 sm:grid-cols-4 gap-3 text-xs">
    <div><span class="text-gray-400">Booked</span><p>{{ call.booked_at.strftime('%b %d, %Y %H:%M') if call.booked_at else "—" }}</p></div>
    <div><span class="text-gray-400">Received</span><p>{{ call.received_at.strftime('%b %d, %Y %H:%M') if call.received_at else "—" }}</p></div>
    <div><span class="text-gray-400">Status</span><p class="capitalize">{{ call.status }}</p></div>
    <div><span class="text-gray-400">Twilio SID</span><p class="font-mono">{{ call.twilio_sid[:6] + "••" if call.twilio_sid else "—" }}</p></div>
  </section>

  <!-- Back -->
  <div class="pt-2">
    <a href="/admin/calls" class="text-blue-600 text-sm font-semibold hover:underline">← Back to Calls</a>
  </div>

</div>
{% endblock %}
