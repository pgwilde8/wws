{% extends "layout/base.html" %}
{% block header %}{% endblock %}
{% block footer %}{% endblock %}
{% block title %}Credentials & Integrations{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto p-4 sm:p-6 space-y-6">

  <!-- Page Header -->
  <header class="bg-white p-5 rounded-2xl shadow-sm border border-gray-200">
    <h1 class="text-xl sm:text-2xl font-extrabold text-gray-900">Credentials & Integrations</h1>
    <p class="text-xs sm:text-sm text-gray-500 mt-1">Add the API keys and services that power your build</p>
  </header>

  <!-- Status Banner -->
  {% if status == "saved" %}
  <div class="bg-green-50 border-l-4 border-green-600 p-3 rounded-xl text-sm text-green-700 font-semibold">
    Keys saved successfully!
  </div>
  {% elif status == "error" %}
  <div class="bg-red-50 border-l-4 border-red-600 p-3 rounded-xl text-sm text-red-700 font-semibold">
    Error saving keys. Try again.
  </div>
  {% endif %}

  <!-- Credentials Cards -->
  <section class="grid sm:grid-cols-1 md:grid-cols-2 gap-4">

    <!-- Stripe -->
    <div class="bg-white p-4 rounded-2xl border shadow-sm">
      <h2 class="text-lg font-bold text-gray-900 mb-1">Stripe</h2>
      <p class="text-xs text-gray-500 mb-3">Payments & Connect onboarding</p>
      <form method="POST" action="/api/stripe/keys">
        <label class="text-xs text-gray-600 font-semibold">Publishable Key</label>
        <input type="text" name="stripe_pk" class="w-full border rounded-lg p-2 text-sm bg-gray-50 mb-2" placeholder="pk_live_xxx">

        <label class="text-xs text-gray-600 font-semibold">Secret Key</label>
        <input type="password" name="stripe_sk" class="w-full border rounded-lg p-2 text-sm bg-gray-50 mb-3" placeholder="••••••••">

        <button type="submit" class="px-5 py-2 bg-blue-600 text-white text-sm font-bold rounded-full hover:opacity-90 transition">
          Save Stripe Keys
        </button>
      </form>
    </div>

<!-- OpenAI -->
<div class="bg-white p-4 rounded-2xl border shadow-sm">
  <h2 class="text-lg font-bold text-gray-900 mb-1">OpenAI</h2>
  <p class="text-xs text-gray-500 mb-3">AI features & bot services</p>

  {% if creds.openai_key %}
    <!-- Saved State Preview -->
    <div class="mb-3 p-2 bg-gray-900 text-gray-100 rounded-lg text-[11px] font-mono w-fit">
      key: {{ creds.openai_key[:6] + "••••••" }}
    </div>
    <div class="text-[10px] text-green-600 font-semibold mb-3">✔ Connected & encrypted</div>
  {% endif %}

  <form method="POST" action="/api/openai/key">
    <label class="text-xs text-gray-600 font-semibold">API Key</label>
    <input type="password" name="openai_key"
      class="w-full border rounded-lg p-2 text-sm bg-gray-50 mb-3"
      placeholder="••••••••">

    <button type="submit"
      class="px-5 py-2 bg-gray-900 text-white text-sm font-bold rounded-full hover:opacity-90 transition">
      {{ "Update OpenAI Key" if creds.openai_key else "Save OpenAI Key" }}
    </button>
  </form>
</div>


    <!-- Twilio -->
    <div class="bg-white p-4 rounded-2xl border shadow-sm">
      <h2 class="text-lg font-bold text-gray-900 mb-1">Twilio</h2>
      <p class="text-xs text-gray-500 mb-3">SMS / Phone notifications</p>
      <form method="POST" action="/api/twilio/creds">
        <label class="text-xs text-gray-600 font-semibold">Account SID</label>
        <input type="text" name="twilio_sid" class="w-full border rounded-lg p-2 text-sm bg-gray-50 mb-2" placeholder="ACxxx">

        <label class="text-xs text-gray-600 font-semibold">Auth Token</label>
        <input type="password" name="twilio_token" class="w-full border rounded-lg p-2 text-sm bg-gray-50 mb-3" placeholder="••••••••">

        <button type="submit" class="px-5 py-2 bg-green-600 text-white text-sm font-bold rounded-full hover:opacity-90 transition">
          Save Twilio
        </button>
      </form>
    </div>

    <!-- Domain (API-side reference, not key) -->
    <div class="bg-white p-4 rounded-2xl border shadow-sm">
      <h2 class="text-lg font-bold text-gray-900 mb-1">Domain</h2>
      <p class="text-xs text-gray-500 mb-3">DNS for live deployment</p>
      <a href="/dashboard/domain" class="inline-block px-5 py-2 bg-blue-100 text-blue-700 text-sm font-bold rounded-full hover:bg-blue-200 transition">
        Configure Domain →
      </a>
    </div>

  </section>

  <!-- Bottom Help CTA -->
  <div class="text-center border-t pt-5">
    <p class="text-xs sm:text-sm text-gray-500 mb-3">Need help connecting credentials?</p>
    <a href="/book-call" class="inline-block px-6 py-2 bg-blue-600 text-white text-sm font-bold rounded-full shadow-sm hover:opacity-90 transition">
      Book a Setup Call
    </a>
  </div>

</div>
{% endblock %}
